var w=Object.defineProperty;var y=(t,n,r)=>n in t?w(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var v=(t,n,r)=>(y(t,typeof n!="symbol"?n+"":n,r),r);var b=(t,n,r)=>new Promise((s,c)=>{var f=e=>{try{i(r.next(e))}catch(a){c(a)}},d=e=>{try{i(r.throw(e))}catch(a){c(a)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(f,d);i((r=r.apply(t,n)).next())});import{a as useDesign,f as useUserStore,a9 as getBotList,aa as sendMsg,ab as wsUrl,ac as Api,ad as getGroupList,ae as getFriendList,w as withInstall}from"./index.e32258ba.js";import{A as defineComponent,r as ref,j as computed,B as openBlock,D as createElementBlock,w as createVNode,a5 as withCtx,aa as Fragment,ao as renderList,a1 as createBlock,K as normalizeClass,u as unref,bn as Avatar,ap as Popover,v as message,P as reactive,a_ as Divider,bo as FormItem,an as Input,aS as Button,a4 as mergeProps,aY as Form,ad as createTextVNode,ai as onUnmounted,H as createBaseVNode,aw as SearchOutlined,X as normalizeStyle,J as toDisplayString,bp as Tag,bq as Image,br as Table,bs as commonjsGlobal,bt as getDefaultExportFromCjs,al as watchEffect,bu as Select,bv as SelectOptGroup,bw as SelectOption}from"./vendor.3083ef3c.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               */var BotSwitch_vue_vue_type_style_index_0_lang="";const _sfc_main$4=defineComponent({setup(t){const{prefixCls:n}=useDesign("botSwitch"),r=ref({id:1,pic:"http://q4.qlogo.cn/g?b=qq&nk="+1+"&s=640"}),s=useUserStore(),c=ref([]),f=computed(()=>s.getQQ),d=()=>b(this,null,function*(){c.value=[];let e=yield getBotList();!f.value&&e.length>0&&s.setQQ(e[0]);for(let a of e)c.value.push({id:a,pic:"http://q4.qlogo.cn/g?b=qq&nk="+a+"&s=640"});r.value={id:f.value,pic:"http://q4.qlogo.cn/g?b=qq&nk="+f.value+"&s=640"}}),i=e=>{s.setQQ(e.id),message.info("\u5207\u6362\u5230QQ: "+e.id),r.value=e,console.log(r)};return d(),(e,a)=>(openBlock(),createElementBlock("div",null,[createVNode(unref(Popover),{title:"\u70B9\u51FB\u4E0B\u5217\u5934\u50CF, \u5207\u6362QQ\u53F7",trigger:"click"},{content:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(c.value,l=>(openBlock(),createBlock(unref(Avatar),{key:l.id,src:l.pic,onClick:o=>i(l),class:normalizeClass(`${unref(n)}__avatar`)},null,8,["src","onClick","class"]))),128))]),default:withCtx(()=>[createVNode(unref(Avatar),{src:r.value.pic},null,8,["src"])]),_:1})]))}});var MessageSendBox_vue_vue_type_style_index_0_lang="";const _hoisted_1$2=createTextVNode("\u53D1\u9001\u6D88\u606F"),_hoisted_2$1=createTextVNode("\u53D1\u9001"),_sfc_main$3=defineComponent({setup(t){const{prefixCls:n}=useDesign("messageSendBox"),r=reactive({gidList:[],msg:""}),s=computed(()=>({labelCol:{span:4},wrapperCol:{span:14}})),c=e=>{r.gidList=e},f=useUserStore(),d=computed(()=>f.getQQ),i=()=>b(this,null,function*(){yield sendMsg({selfId:d.value,gidList:r.gidList,message:r.msg})});return(e,a)=>(openBlock(),createElementBlock("div",{class:normalizeClass(`${unref(n)}__sendbox`)},[createVNode(unref(Divider),null,{default:withCtx(()=>[_hoisted_1$2]),_:1}),createVNode(unref(Form),mergeProps({layout:"horizontal"},unref(s),{model:unref(r)}),{default:withCtx(()=>[createVNode(unref(MessageSendSelect),{onChangeGroupIdList:c}),createVNode(unref(FormItem),{label:"\u6D88\u606F"},{default:withCtx(()=>[createVNode(unref(Input).TextArea,{value:unref(r).msg,"onUpdate:value":a[0]||(a[0]=l=>unref(r).msg=l),placeholder:"\u8BF7\u8F93\u5165\u6D88\u606F",style:{width:"400px"},rows:4},null,8,["value"])]),_:1}),createVNode(unref(FormItem),{"wrapper-col":{span:14,offset:4}},{default:withCtx(()=>[createVNode(unref(Button),{type:"primary",onClick:i},{default:withCtx(()=>[_hoisted_2$1]),_:1})]),_:1})]),_:1},16,["model"])],2))}});class Websocket1{constructor(n){v(this,"socket");this.socket=new WebSocket(n)}onMessage(n){this.socket.onmessage=n}onOpen(n){this.socket.onopen=n}onError(n){this.socket.onerror=n}onClose(n){this.socket.onclose=n}send(n){this.socket.send(JSON.stringify(n))}}var elements={};Object.defineProperty(elements,"__esModule",{value:!0});var segment=elements.segment=void 0;segment=elements.segment={text(t){return{type:"text",text:t}},face(t){return{type:"face",id:t}},sface(t,n){return{type:"sface",id:t,text:n}},bface(t,n){return{type:"bface",file:t,text:n}},rps(t){return{type:"rps",id:t}},dice(t){return{type:"dice",id:t}},at(t,n,r){return typeof t=="number"||t==="all"?{type:"at",qq:t,text:n,dummy:r}:{type:"at",qq:0,id:String(t),text:n,dummy:r}},image(t,n,r,s){return{type:"image",file:t,cache:n,timeout:r,headers:s}},flash(t,n,r,s){return{type:"flash",file:t,cache:n,timeout:r,headers:s}},record(t){return{type:"record",file:t}},video(t){return{type:"video",file:t}},json(t){return{type:"json",data:t}},xml(t,n){return{type:"xml",data:t,id:n}},mirai(t){return{type:"mirai",data:t}},share(t,n,r,s){return{type:"share",url:t,title:n,image:r,content:s}},location(t,n,r,s){return{type:"location",lat:t,lng:n,address:r,id:s}},poke(t){return{type:"poke",id:t}},fromCqcode(t){const n=[],r=t.matchAll(/\[CQ:[^\]]+\]/g);let s=0;for(let c of r){const f=t.slice(s,c.index).replace(/&#91;|&#93;|&amp;/g,unescapeCQ);f&&n.push({type:"text",text:f});const d=c[0];let i=d.replace("[CQ:","type=");i=i.substr(0,i.length-1),n.push(qs(i)),s=c.index+d.length}if(s<t.length){const c=t.slice(s).replace(/&#91;|&#93;|&amp;/g,unescapeCQ);c&&n.push({type:"text",text:c})}return n}};function unescapeCQ(t){return t==="&#91;"?"[":t==="&#93;"?"]":t==="&amp;"?"&":""}function unescapeCQInside(t){return t==="&#44;"?",":t==="&#91;"?"[":t==="&#93;"?"]":t==="&amp;"?"&":""}function qs(t,n=",",r="="){const s={},c=t.split(n);for(let f of c){const d=f.indexOf(r);d!==-1&&(s[f.substring(0,d)]=f.substr(d+1).replace(/&#44;|&#91;|&#93;|&amp;/g,unescapeCQInside))}for(let f in s)try{f!=="text"&&(s[f]=JSON.parse(s[f]))}catch(d){}return s}const _hoisted_1$1=createTextVNode("\u6D88\u606F"),_hoisted_2={style:{padding:"8px"}},_hoisted_3=createTextVNode(" Search "),_hoisted_4=createTextVNode(" Reset "),_hoisted_5={key:0},_hoisted_6=createTextVNode("\u7FA4\u804A"),_hoisted_7={key:1},_hoisted_8=createTextVNode("\u79C1\u804A"),_hoisted_9={key:0},_hoisted_10={key:1},_hoisted_11={key:2},_hoisted_12={key:3},_sfc_main$2=defineComponent({setup(__props){const searchInput=ref(),columns=[{title:"\u65F6\u95F4",dataIndex:"time",key:"time"},{title:"\u6D88\u606Fid",dataIndex:"message_id",key:"message_id",slots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon"},onFilter:(t,n)=>n.message_id.toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:t=>{t&&setTimeout(()=>{searchInput.value.focus()},100)}},{title:"\u7FA4\u540D",dataIndex:"group_name",key:"group_name",slots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"group_name"},onFilter:(t,n)=>n.group_name.toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:t=>{t&&setTimeout(()=>{searchInput.value.focus()},100)}},{title:"\u6635\u79F0",dataIndex:"nickname",key:"nickname",slots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"nickname"},onFilter:(t,n)=>n.nickname.toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:t=>{t&&setTimeout(()=>{searchInput.value.focus()},100)}},{title:"\u6D88\u606F\u7C7B\u578B",dataIndex:"message_type",key:"message_type",slots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"message_type"},onFilter:(t,n)=>n.message_type.toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:t=>{t&&setTimeout(()=>{searchInput.value.focus()},100)}},{title:"\u6D88\u606F\u5185\u5BB9",dataIndex:"raw_message",key:"raw_message",slots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"raw_message"},onFilter:(t,n)=>n.raw_message.toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:t=>{t&&setTimeout(()=>{searchInput.value.focus()},100)}}],msgTableData=ref([]),state=reactive({searchText:"",searchedColumn:""}),handleSearch=(t,n,r)=>{n(),state.searchText=t[0],state.searchedColumn=r},handleReset=t=>{t(),state.searchText=""},ws=new Websocket1(wsUrl+Api.data);return ws.onOpen(t=>{console.log(t),console.log("msg ws\u8FDE\u63A5\u5DF2\u6253\u5F00")}),ws.onMessage(event=>{let myDate=new Date;console.log(event.data);let result=eval("("+event.data+")");result.time=myDate.toLocaleString(),result.key=String(result.message_id),msgTableData.value.unshift(result),msgTableData.value.length>1e3&&msgTableData.value.shift()}),ws.onClose(()=>{console.log("ws\u8FDE\u63A5\u5DF2\u5173\u95ED")}),ws.onError(t=>{console.log("ws\u51FA\u73B0\u9519\u8BEF"+t)}),onUnmounted(()=>{ws.socket.close()}),(t,n)=>(openBlock(),createElementBlock("div",null,[createVNode(unref(Divider),null,{default:withCtx(()=>[_hoisted_1$1]),_:1}),createVNode(unref(Table),{columns,"data-source":msgTableData.value},{filterDropdown:withCtx(({setSelectedKeys:r,selectedKeys:s,confirm:c,clearFilters:f,column:d})=>[createBaseVNode("div",_hoisted_2,[createVNode(unref(Input),{ref:(i,e)=>{e.searchInput=i,searchInput.value=i},placeholder:`\u641C\u7D22 ${d.title}`,value:s[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:i=>r(i.target.value?[i.target.value]:[]),onPressEnter:i=>handleSearch(s,c,d.dataIndex)},null,8,["placeholder","value","onChange","onPressEnter"]),createVNode(unref(Button),{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:i=>handleSearch(s,c,d.dataIndex)},{icon:withCtx(()=>[createVNode(unref(SearchOutlined))]),default:withCtx(()=>[_hoisted_3]),_:2},1032,["onClick"]),createVNode(unref(Button),{size:"small",style:{width:"90px"},onClick:i=>handleReset(f)},{default:withCtx(()=>[_hoisted_4]),_:2},1032,["onClick"])])]),filterIcon:withCtx(r=>[createVNode(unref(SearchOutlined),{style:normalizeStyle({color:r?"#108ee9":void 0})},null,8,["style"])]),nickname:withCtx(({record:r})=>[createBaseVNode("span",null,toDisplayString(r.nickname+" ("+r.user_id+")"),1)]),group_name:withCtx(({record:r})=>[createBaseVNode("span",null,toDisplayString(r.group_name+" ("+r.group_id+")"),1)]),message_type:withCtx(({text:r})=>[r==="group"?(openBlock(),createElementBlock("span",_hoisted_5,[createVNode(unref(Tag),{color:"green"},{default:withCtx(()=>[_hoisted_6]),_:1})])):(openBlock(),createElementBlock("span",_hoisted_7,[createVNode(unref(Tag),{color:"red"},{default:withCtx(()=>[_hoisted_8]),_:1})]))]),raw_message:withCtx(({text:r})=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(segment).fromCqcode(r),(s,c)=>(openBlock(),createElementBlock("li",{key:c},[s.type==="text"?(openBlock(),createElementBlock("div",_hoisted_9,toDisplayString(s.text),1)):s.type==="image"?(openBlock(),createElementBlock("div",_hoisted_10,[createVNode(unref(Image),{width:200,src:s.url},null,8,["src"])])):s.type==="face"?(openBlock(),createElementBlock("div",_hoisted_11,[createVNode(unref(Image),{width:50,src:"https://blog.imashimaro.com/emoji/qq/"+s.id+"@2x.gif"},null,8,["src"])])):(openBlock(),createElementBlock("div",_hoisted_12,toDisplayString(s),1))]))),128))]),_:1},8,["data-source"])]))}});var ansi_up={};(function(t){(function(n,r){if(typeof t.nodeName!="string")r(t);else{var s={};r(s),n.AnsiUp=s.default}})(commonjsGlobal,function(n){var r=this&&this.__makeTemplateObject||function(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i},s;(function(i){i[i.EOS=0]="EOS",i[i.Text=1]="Text",i[i.Incomplete=2]="Incomplete",i[i.ESC=3]="ESC",i[i.Unknown=4]="Unknown",i[i.SGR=5]="SGR",i[i.OSCURL=6]="OSCURL"})(s||(s={}));var c=function(){function i(){this.VERSION="5.1.0",this.setup_palettes(),this._use_classes=!1,this.bold=!1,this.italic=!1,this.underline=!1,this.fg=this.bg=null,this._buffer="",this._url_whitelist={http:1,https:1}}return Object.defineProperty(i.prototype,"use_classes",{get:function(){return this._use_classes},set:function(e){this._use_classes=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"url_whitelist",{get:function(){return this._url_whitelist},set:function(e){this._url_whitelist=e},enumerable:!1,configurable:!0}),i.prototype.setup_palettes=function(){var e=this;this.ansi_colors=[[{rgb:[0,0,0],class_name:"ansi-black"},{rgb:[187,0,0],class_name:"ansi-red"},{rgb:[0,187,0],class_name:"ansi-green"},{rgb:[187,187,0],class_name:"ansi-yellow"},{rgb:[0,0,187],class_name:"ansi-blue"},{rgb:[187,0,187],class_name:"ansi-magenta"},{rgb:[0,187,187],class_name:"ansi-cyan"},{rgb:[255,255,255],class_name:"ansi-white"}],[{rgb:[85,85,85],class_name:"ansi-bright-black"},{rgb:[255,85,85],class_name:"ansi-bright-red"},{rgb:[0,255,0],class_name:"ansi-bright-green"},{rgb:[255,255,85],class_name:"ansi-bright-yellow"},{rgb:[85,85,255],class_name:"ansi-bright-blue"},{rgb:[255,85,255],class_name:"ansi-bright-magenta"},{rgb:[85,255,255],class_name:"ansi-bright-cyan"},{rgb:[255,255,255],class_name:"ansi-bright-white"}]],this.palette_256=[],this.ansi_colors.forEach(function(m){m.forEach(function(x){e.palette_256.push(x)})});for(var a=[0,95,135,175,215,255],l=0;l<6;++l)for(var o=0;o<6;++o)for(var u=0;u<6;++u){var p={rgb:[a[l],a[o],a[u]],class_name:"truecolor"};this.palette_256.push(p)}for(var h=8,g=0;g<24;++g,h+=10){var _={rgb:[h,h,h],class_name:"truecolor"};this.palette_256.push(_)}},i.prototype.escape_txt_for_html=function(e){return e.replace(/[&<>"']/gm,function(a){if(a==="&")return"&amp;";if(a==="<")return"&lt;";if(a===">")return"&gt;";if(a==='"')return"&quot;";if(a==="'")return"&#x27;"})},i.prototype.append_buffer=function(e){var a=this._buffer+e;this._buffer=a},i.prototype.get_next_packet=function(){var e={kind:s.EOS,text:"",url:""},a=this._buffer.length;if(a==0)return e;var l=this._buffer.indexOf("");if(l==-1)return e.kind=s.Text,e.text=this._buffer,this._buffer="",e;if(l>0)return e.kind=s.Text,e.text=this._buffer.slice(0,l),this._buffer=this._buffer.slice(l),e;if(l==0){if(a==1)return e.kind=s.Incomplete,e;var o=this._buffer.charAt(1);if(o!="["&&o!="]")return e.kind=s.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;if(o=="["){this._csi_regex||(this._csi_regex=f(r([`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          [                      # CSI
                          ([<-?]?)              # private-mode char
                          ([d;]*)                    # any digits or semicolons
                          ([ -/]?               # an intermediate modifier
                          [@-~])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          [                      # CSI
                          [ -~]*                # anything legal
                          ([\0-:])              # anything illegal
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \\x1b\\[                      # CSI
                          ([\\x3c-\\x3f]?)              # private-mode char
                          ([\\d;]*)                    # any digits or semicolons
                          ([\\x20-\\x2f]?               # an intermediate modifier
                          [\\x40-\\x7e])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \\x1b\\[                      # CSI
                          [\\x20-\\x7e]*                # anything legal
                          ([\\x00-\\x1f:])              # anything illegal
                        )
                    `])));var u=this._buffer.match(this._csi_regex);if(u===null)return e.kind=s.Incomplete,e;if(u[4])return e.kind=s.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;u[1]!=""||u[3]!="m"?e.kind=s.Unknown:e.kind=s.SGR,e.text=u[2];var p=u[0].length;return this._buffer=this._buffer.slice(p),e}if(o=="]"){if(a<4)return e.kind=s.Incomplete,e;if(this._buffer.charAt(2)!="8"||this._buffer.charAt(3)!=";")return e.kind=s.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;this._osc_st||(this._osc_st=d(r([`
                        (?:                         # legal sequence
                          (\\)                    # ESC                           |                           # alternate
                          (\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\0-]                 # anything illegal
                          |                           # alternate
                          [\b-]                 # anything illegal
                          |                           # alternate
                          [-]                 # anything illegal
                        )
                    `],[`
                        (?:                         # legal sequence
                          (\\x1b\\\\)                    # ESC \\
                          |                           # alternate
                          (\\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\\x00-\\x06]                 # anything illegal
                          |                           # alternate
                          [\\x08-\\x1a]                 # anything illegal
                          |                           # alternate
                          [\\x1c-\\x1f]                 # anything illegal
                        )
                    `]))),this._osc_st.lastIndex=0;{var h=this._osc_st.exec(this._buffer);if(h===null)return e.kind=s.Incomplete,e;if(h[3])return e.kind=s.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e}{var g=this._osc_st.exec(this._buffer);if(g===null)return e.kind=s.Incomplete,e;if(g[3])return e.kind=s.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e}this._osc_regex||(this._osc_regex=f(r([`
                        ^                           # beginning of line
                                                    #
                        ]8;                    # OSC Hyperlink
                        [ -:<-~]*       # params (excluding ;)
                        ;                           # end of params
                        ([!-~]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                        ([ -~]+)              # TEXT capture
                        ]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                        \\x1b\\]8;                    # OSC Hyperlink
                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)
                        ;                           # end of params
                        ([\\x21-\\x7e]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                        ([\\x20-\\x7e]+)              # TEXT capture
                        \\x1b\\]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                    `])));var u=this._buffer.match(this._osc_regex);if(u===null)return e.kind=s.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;e.kind=s.OSCURL,e.url=u[1],e.text=u[2];var p=u[0].length;return this._buffer=this._buffer.slice(p),e}}},i.prototype.ansi_to_html=function(e){this.append_buffer(e);for(var a=[];;){var l=this.get_next_packet();if(l.kind==s.EOS||l.kind==s.Incomplete)break;l.kind==s.ESC||l.kind==s.Unknown||(l.kind==s.Text?a.push(this.transform_to_html(this.with_state(l))):l.kind==s.SGR?this.process_ansi(l):l.kind==s.OSCURL&&a.push(this.process_hyperlink(l)))}return a.join("")},i.prototype.with_state=function(e){return{bold:this.bold,italic:this.italic,underline:this.underline,fg:this.fg,bg:this.bg,text:e.text}},i.prototype.process_ansi=function(e){for(var a=e.text.split(";");a.length>0;){var l=a.shift(),o=parseInt(l,10);if(isNaN(o)||o===0)this.fg=this.bg=null,this.bold=!1,this.italic=!1,this.underline=!1;else if(o===1)this.bold=!0;else if(o===3)this.italic=!0;else if(o===4)this.underline=!0;else if(o===22)this.bold=!1;else if(o===23)this.italic=!1;else if(o===24)this.underline=!1;else if(o===39)this.fg=null;else if(o===49)this.bg=null;else if(o>=30&&o<38)this.fg=this.ansi_colors[0][o-30];else if(o>=40&&o<48)this.bg=this.ansi_colors[0][o-40];else if(o>=90&&o<98)this.fg=this.ansi_colors[1][o-90];else if(o>=100&&o<108)this.bg=this.ansi_colors[1][o-100];else if((o===38||o===48)&&a.length>0){var u=o===38,p=a.shift();if(p==="5"&&a.length>0){var h=parseInt(a.shift(),10);h>=0&&h<=255&&(u?this.fg=this.palette_256[h]:this.bg=this.palette_256[h])}if(p==="2"&&a.length>2){var g=parseInt(a.shift(),10),_=parseInt(a.shift(),10),m=parseInt(a.shift(),10);if(g>=0&&g<=255&&_>=0&&_<=255&&m>=0&&m<=255){var x={rgb:[g,_,m],class_name:"truecolor"};u?this.fg=x:this.bg=x}}}}},i.prototype.transform_to_html=function(e){var a=e.text;if(a.length===0||(a=this.escape_txt_for_html(a),!e.bold&&!e.italic&&!e.underline&&e.fg===null&&e.bg===null))return a;var l=[],o=[],u=e.fg,p=e.bg;e.bold&&l.push("font-weight:bold"),e.italic&&l.push("font-style:italic"),e.underline&&l.push("text-decoration:underline"),this._use_classes?(u&&(u.class_name!=="truecolor"?o.push(u.class_name+"-fg"):l.push("color:rgb("+u.rgb.join(",")+")")),p&&(p.class_name!=="truecolor"?o.push(p.class_name+"-bg"):l.push("background-color:rgb("+p.rgb.join(",")+")"))):(u&&l.push("color:rgb("+u.rgb.join(",")+")"),p&&l.push("background-color:rgb("+p.rgb+")"));var h="",g="";return o.length&&(h=' class="'+o.join(" ")+'"'),l.length&&(g=' style="'+l.join(";")+'"'),"<span"+g+h+">"+a+"</span>"},i.prototype.process_hyperlink=function(e){var a=e.url.split(":");if(a.length<1||!this._url_whitelist[a[0]])return"";var l='<a href="'+this.escape_txt_for_html(e.url)+'">'+this.escape_txt_for_html(e.text)+"</a>";return l},i}();function f(i){for(var e=[],a=1;a<arguments.length;a++)e[a-1]=arguments[a];var l=i.raw[0],o=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,u=l.replace(o,"");return new RegExp(u)}function d(i){for(var e=[],a=1;a<arguments.length;a++)e[a-1]=arguments[a];var l=i.raw[0],o=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,u=l.replace(o,"");return new RegExp(u,"g")}Object.defineProperty(n,"__esModule",{value:!0}),n.default=c})})(ansi_up);var AnsiUp=getDefaultExportFromCjs(ansi_up);function removeHtmlTab(t){return t.replace(/<[^<>]+?>/g,"")}function escape2Html(t){const n={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return t.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(r,s){return n[s]})}var LogWebsocket_vue_vue_type_style_index_0_lang="";const _hoisted_1=createTextVNode("\u65E5\u5FD7"),_sfc_main$1=defineComponent({setup(t){const{prefixCls:n}=useDesign("logWebsocket"),r=ref([]),s=[{title:"\u5185\u5BB9",dataIndex:"msg",key:"msg",slots:{customRender:"msg"}}],c=new Websocket1(wsUrl+Api.getLog),f=new AnsiUp;return c.onOpen(d=>{console.log(d),console.log("log ws\u8FDE\u63A5\u5DF2\u6253\u5F00")}),c.onMessage(d=>{let i=f.ansi_to_html(d.data);r.value.unshift({msg:escape2Html(removeHtmlTab(i))}),r.value.length>1e3&&r.value.shift()}),c.onClose(()=>{console.log("ws\u8FDE\u63A5\u5DF2\u5173\u95ED")}),c.onError(d=>{console.log("ws\u51FA\u73B0\u9519\u8BEF"+d)}),onUnmounted(()=>{c.socket.close()}),(d,i)=>(openBlock(),createElementBlock("div",null,[createVNode(unref(Divider),null,{default:withCtx(()=>[_hoisted_1]),_:1}),createVNode(unref(Table),{columns:s,"data-source":r.value,class:normalizeClass(`${unref(n)}__table`)},{msg:withCtx(({text:e})=>[createBaseVNode("span",{class:normalizeClass(`${unref(n)}__msg`)},toDisplayString(e),3)]),_:1},8,["data-source","class"])]))}}),_sfc_main=defineComponent({emits:["changeGroupIdList"],setup(t,{emit:n}){const r=ref([0]),s=useUserStore(),c=computed(()=>s.getQQ),f=ref([]),d=ref([]),i=()=>b(this,null,function*(){f.value=yield getGroupList({selfId:c.value}),f.value.unshift({group_id:0,group_name:"\u5168\u90E8\u7FA4\u804A",group_create_time:0,group_level:0,max_member_count:0,member_count:0})}),e=()=>b(this,null,function*(){d.value=yield getFriendList({selfId:c.value})}),a=()=>{n("changeGroupIdList",r.value)};return watchEffect(()=>{i(),e()}),(l,o)=>(openBlock(),createElementBlock("div",null,[createVNode(unref(FormItem),{label:"\u7FA4\u804A & \u597D\u53CB"},{default:withCtx(()=>[createVNode(unref(Select),{value:r.value,"onUpdate:value":o[0]||(o[0]=u=>r.value=u),mode:"multiple",style:{width:"40%"},placeholder:"\u8BF7\u9009\u62E9\u7FA4\u804A & \u597D\u53CB",onChange:a},{default:withCtx(()=>[createVNode(unref(SelectOptGroup),{label:"\u7FA4\u804A"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(f.value,u=>(openBlock(),createBlock(unref(SelectOption),{value:u.group_id,key:u.group_id},{default:withCtx(()=>[createTextVNode(toDisplayString(u.group_name+" ("+u.group_id+")"),1)]),_:2},1032,["value"]))),128))]),_:1}),createVNode(unref(SelectOptGroup),{label:"\u597D\u53CB"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(d.value,u=>(openBlock(),createBlock(unref(SelectOption),{value:-u.user_id,key:u.user_id},{default:withCtx(()=>[createTextVNode(toDisplayString(u.nickname+" ("+u.user_id+")"),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]))}}),BotSwitch=withInstall(_sfc_main$4),MessageSendBox=withInstall(_sfc_main$3),MessageWebsocket=withInstall(_sfc_main$2),LogWebsocket=withInstall(_sfc_main$1),MessageSendSelect=withInstall(_sfc_main);export{BotSwitch as B,LogWebsocket as L,MessageSendBox as M,MessageWebsocket as a};
